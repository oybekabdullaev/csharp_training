DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'VidzyCodeFirst.Migrations.Configuration'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '202011261439386_InitialModel'
BEGIN
    CREATE TABLE [dbo].[Genres] (
        [Id] [tinyint] NOT NULL,
        [Name] [nvarchar](max),
        CONSTRAINT [PK_dbo.Genres] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[Videos] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](max),
        [ReleaseDate] [datetime] NOT NULL,
        CONSTRAINT [PK_dbo.Videos] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[VideoGenres] (
        [Video_Id] [int] NOT NULL,
        [Genre_Id] [tinyint] NOT NULL,
        CONSTRAINT [PK_dbo.VideoGenres] PRIMARY KEY ([Video_Id], [Genre_Id])
    )
    CREATE INDEX [IX_Video_Id] ON [dbo].[VideoGenres]([Video_Id])
    CREATE INDEX [IX_Genre_Id] ON [dbo].[VideoGenres]([Genre_Id])
    ALTER TABLE [dbo].[VideoGenres] ADD CONSTRAINT [FK_dbo.VideoGenres_dbo.Videos_Video_Id] FOREIGN KEY ([Video_Id]) REFERENCES [dbo].[Videos] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[VideoGenres] ADD CONSTRAINT [FK_dbo.VideoGenres_dbo.Genres_Genre_Id] FOREIGN KEY ([Genre_Id]) REFERENCES [dbo].[Genres] ([Id]) ON DELETE CASCADE
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202011261439386_InitialModel', N'VidzyCodeFirst.Migrations.Configuration',  0x1F8B0800000000000400DD59CD6EE33610BE17E83B083AB545D6CACF651BD8BBC83A49617413075112F41630D2D8214A512A4905F6167DB21EFA487D850EF52F52B2E5ECC2DB1601029B9C19CECFC7E1CCF8EF3FFF1ABF5F45CC79012169CC27EED1E8D07580077148F972E2A66AF1E6ADFBFEDDB7DF8C2FC268E53C9474279A0E39B99CB8CF4A25A79E27836788881C453410B18C176A14C49147C2D83B3E3CFCD13B3AF20045B828CB71C6B729573482EC0B7E9DC63C8044A5845DC5213059ACE38E9F4975AE49043221014CDC071A7E5A4F91EC920AA95CE78C51825AF8C016AE43388F1551A8E3E9BD045F89982FFD041708BB5B2780740BC22414BA9FD6E443CD383CD666783563292A48A58AA31D051E9D147EF14CF65779D7ADFC869EBB400FABB5B63AF3DEC4FD09B840CBCD934EA74C682AD3B3A38CFEC069AF1E541840A8E8BF03679A32950A9870489520ECC0B9499F180D7E86F55DFC2BF0094F196B6A86BAE15E6B01976E449C8050EB5B5814FACE42D7F1DA7C9EC958B1357872633EAC151A7B8D6793270655DCBD8DECFA7F2900C18377C075AEC8EA23F0A57A9EB8F8D1752EE90AC272A5907ACF295E19645222B50FB9262F7499F9DA380E5D0BB1749D5B60D9B67CA6498EE451B6F5988500092E451CDDC6AC6429D61FEF8858025E81BBB863D38F531118CA8CBD1A151BB19249DA012B19FD7F162B33AE4E8E3BC0D230DC57B100F42C08A220BC214A81E05A0664AEFB3AC0320E41180191704E547596FE7C47A30137A117A425065F0BD212879D202D113C04A46752C601CD7468A2B43CBF6DCE050F9D4DCAE491A88CC0682032698258C49327EE0F967F7A045657B01658E4D98D02C75EC31AFB26E27BA80845B0D5867ECA1661A53A6E253E75C5C59405524CDDB5501F9411D2DACF6DD52DD3DBEC65DAB2D80B571AEC0D4B0D1915741A245DD032EFFF96E056FAD6AA7A034594E16C88287534D34BDBAC0EFC5641ACAB192F2F67CAB2C7EBA97BC6572449304734EAA062C5F1F32268FAC6DFBD428872195E203B0A854ADBEA24CC786409C62E1E5DA677CC2DE489E854320D238BAC05D91E3C9547B5506947AA445949AE3FB7EE45AB623105D4CEBB447B22CCD799696086D8E6CBCA4FC288E87838A6314B23DEF7F86CE2CE9F82267FBE624B187B86E2A66B3CCB3706464D4F0F8A4371673E230E791ED83D0E3D7C5F3B0E7D125AEF6D53506B63FF716D67A68EE056797773042BB2CE38755E1A9D57BB8A5C2345DB2E1914E05C545798B54BAA8377D4A9C8F9AFD42913B2A34EE6E36147D17A434C920A43D55B62BC19E3227F6F6FA8AD849E93B80EEAFE828EC264EEAFA58268A40946FE6F6CCA28A2B626B8229C2E40AABC8677B1AF3D36FAF27F4F8FEC4919B2218DF2DEBB1045F99A6AB77E46D3CA5F88089E89F82E22ABEF9B92ECFE61C75E70EFEEC85CB1B5EDDA8FAF06F55A217E56DB7BADDDFCFE6A2C6EC89536715F12DB1EAFFA9846D4AC0665C643584DDCDF33A65367F6CB63C977E0CC05669053E7D0F963E768D66A1B3768800225EF0E0ABCAE31ED7CF3CCFE637B477A643DB5737E8E2054E09C0579329D121990D0F69A7E87369E5EB47DA60A431A593DCB8505087D1F09C3E74A2A810F9655D2DC08CA039A10D6B2DA7E738764116D5225CFDC398704B84E0FB681434EDB546254A20DF76E73406FB3BF05385D8549237476D43A03F63F03CEF050EE17389BEAC02F0E9CEE2991DD990F1803F54F81F23210DFB5279D9EF2ACD8330CE99C10F50F88BA24774F6ABA25F729DEDCEC3DA3C784AD53AA6ABCB47958D5D3E2D809DFEA7BB70EA95A669B8DD8F0F9D42063CB41D81663BB7B273B4959C3967D19BBC330CE6E98F086367EA7C40C21E9B216A17FB5E410B4EE664533E38BB84C128646258951CC5C812258429233A1E882040AB7039032FBA9E081B014492EA22708677C9EAA24556832444FACF5D3834E359BCECF268E6D9DC7F3249BEA7F0913504DAAABE039FF905216567A5F76D4523D22740E2BEA7D1D4BA5EBFEE5BA92741DF381820AF755A9F70EA284A13039E73E7981D7E8762FE1232C49B02EFBDE7E21DB03D176FBF89C92A520912C64D4FCF815311C46AB77FF004FB62111AE1F0000 , N'6.4.4')
END

IF @CurrentMigration < '202011261553203_PopulateGenresTable'
BEGIN
    INSERT INTO Genres VALUES (1, 'Comedy')
    INSERT INTO Genres VALUES (2, 'Adventure')
    INSERT INTO Genres VALUES (3, 'Horror')
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202011261553203_PopulateGenresTable', N'VidzyCodeFirst.Migrations.Configuration',  0x1F8B0800000000000400DD59CD6EE33610BE17E83B083AB545D6CACF651BD8BBC83A49617413075112F41630D2D8214A512A4905F6167DB21EFA487D850EF52F52B2E5ECC2DB1601029B9C19CECFC7E1CCF8EF3FFF1ABF5F45CC79012169CC27EED1E8D07580077148F972E2A66AF1E6ADFBFEDDB7DF8C2FC268E53C9474279A0E39B99CB8CF4A25A79E27836788881C453410B18C176A14C49147C2D83B3E3CFCD13B3AF20045B828CB71C6B729573482EC0B7E9DC63C8044A5845DC5213059ACE38E9F4975AE49043221014CDC071A7E5A4F91EC920AA95CE78C51825AF8C016AE43388F1551A8E3E9BD045F89982FFD041708BB5B2780740BC22414BA9FD6E443CD383CD666783563292A48A58AA31D051E9D147EF14CF65779D7ADFC869EBB400FABB5B63AF3DEC4FD09B840CBCD934EA74C682AD3B3A38CFEC069AF1E541840A8E8BF03679A32950A9870489520ECC0B9499F180D7E86F55DFC2BF0094F196B6A86BAE15E6B01976E449C8050EB5B5814FACE42D7F1DA7C9EC958B1357872633EAC151A7B8D6793270655DCBD8DECFA7F2900C18377C075AEC8EA23F0A57A9EB8F8D1752EE90AC272A5907ACF295E19645222B50FB9262F7499F9DA380E5D0BB1749D5B60D9B67CA6498EE451B6F5988500092E451CDDC6AC6429D61FEF8858025E81BBB863D38F531118CA8CBD1A151BB19249DA012B19FD7F162B33AE4E8E3BC0D230DC57B100F42C08A220BC214A81E05A0664AEFB3AC0320E41180191704E547596FE7C47A30137A117A425065F0BD212879D202D113C04A46752C601CD7468A2B43CBF6DCE050F9D4DCAE491A88CC0682032698258C49327EE0F967F7A045657B01658E4D98D02C75EC31AFB26E27BA80845B0D5867ECA1661A53A6E253E75C5C59405524CDDB5501F9411D2DACF6DD52DD3DBEC65DAB2D80B571AEC0D4B0D1915741A245DD032EFFF96E056FAD6AA7A034594E16C88287534D34BDBAC0EFC5641ACAB192F2F67CAB2C7EBA97BC6572449304734EAA062C5F1F32268FAC6DFBD428872195E203B0A854ADBEA24CC786409C62E1E5DA677CC2DE489E854320D238BAC05D91E3C9547B5506947AA445949AE3FB7EE45AB623105D4CEBB447B22CCD799696086D8E6CBCA4FC288E87838A6314B23DEF7F86CE2CE9F82267FBE624B187B86E2A66B3CCB3706464D4F0F8A4371673E230E791ED83D0E3D7C5F3B0E7D125AEF6D53506B63FF716D67A68EE056797773042BB2CE38755E1A9D57BB8A5C2345DB2E1914E05C545798B54BAA8377D4A9C8F9AFD42913B2A34EE6E36147D17A434C920A43D55B62BC19E3227F6F6FA8AD849E93B80EEAFE828EC264EEAFA58268A40946FE6F6CCA28A2B626B8229C2E40AABC8677B1AF3D36FAF27F4F8FEC4919B2218DF2DEBB1045F99A6AB77E46D3CA5F88089E89F82E22ABEF9B92ECFE61C75E70EFEEC85CB1B5EDDA8FAF06F55A217E56DB7BADDDFCFE6A2C6EC89536715F12DB1EAFFA9846D4AC0665C643584DDCDF33A65367F6CB63C977E0CC05669053E7D0F963E768D66A1B3768800225EF0E0ABCAE31ED7CF3CCFE637B477A643DB5737E8E2054E09C0579329D121990D0F69A7E87369E5EB47DA60A431A593DCB8505087D1F09C3E74A2A810F9655D2DC08CA039A10D6B2DA7E738764116D5225CFDC398704B84E0FB681434EDB546254A20DF76E73406FB3BF05385D8549237476D43A03F63F03CEF050EE17389BEAC02F0E9CEE2991DD990F1803F54F81F23210DFB5279D9EF2ACD8330CE99C10F50F88BA24774F6ABA25F729DEDCEC3DA3C784AD53AA6ABCB47958D5D3E2D809DFEA7BB70EA95A669B8DD8F0F9D42063CB41D81663BB7B273B4959C3967D19BBC330CE6E98F086367EA7C40C21E9B216A17FB5E410B4EE664533E38BB84C128646258951CC5C812258429233A1E882040AB7039032FBA9E081B014492EA22708677C9EAA24556832444FACF5D3834E359BCECF268E6D9DC7F3249BEA7F0913504DAAABE039FF905216567A5F76D4523D22740E2BEA7D1D4BA5EBFEE5BA92741DF381820AF755A9F70EA284A13039E73E7981D7E8762FE1232C49B02EFBDE7E21DB03D176FBF89C92A520912C64D4FCF815311C46AB77FF004FB62111AE1F0000 , N'6.4.4')
END

IF @CurrentMigration < '202011261613069_EditGenreToVideoRelationshipToOneToMany'
BEGIN
    IF object_id(N'[dbo].[FK_dbo.VideoGenres_dbo.Videos_Video_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[VideoGenres] DROP CONSTRAINT [FK_dbo.VideoGenres_dbo.Videos_Video_Id]
    IF object_id(N'[dbo].[FK_dbo.VideoGenres_dbo.Genres_Genre_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[VideoGenres] DROP CONSTRAINT [FK_dbo.VideoGenres_dbo.Genres_Genre_Id]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Video_Id' AND object_id = object_id(N'[dbo].[VideoGenres]', N'U'))
        DROP INDEX [IX_Video_Id] ON [dbo].[VideoGenres]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Genre_Id' AND object_id = object_id(N'[dbo].[VideoGenres]', N'U'))
        DROP INDEX [IX_Genre_Id] ON [dbo].[VideoGenres]
    ALTER TABLE [dbo].[Videos] ADD [Genre_Id] [tinyint]
    CREATE INDEX [IX_Genre_Id] ON [dbo].[Videos]([Genre_Id])
    ALTER TABLE [dbo].[Videos] ADD CONSTRAINT [FK_dbo.Videos_dbo.Genres_Genre_Id] FOREIGN KEY ([Genre_Id]) REFERENCES [dbo].[Genres] ([Id])
    DROP TABLE [dbo].[VideoGenres]
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202011261613069_EditGenreToVideoRelationshipToOneToMany', N'VidzyCodeFirst.Migrations.Configuration',  0x1F8B0800000000000400D559DB6EE336107D2FD07F10F4D41659CB495EB686BD8BAC9314463717444ED0B78096C60E518A52492AB0B7E897F5A19FD45FE8507791B2237BBBD9160102879C19CEE5CCCDF9FBCFBFC6EFD711739E41481AF3897B3C18BA0EF0200E295F4DDC542DDFBC75DFBFFBF69BF14518AD9D8792EE54D321279713F749A964E47932788288C841440311CB78A906411C79248CBD93E1F047EFF8D80314E1A22CC719DFA55CD108B23FF0CF69CC0348544AD8551C0293C539DEF89954E79A44201312C0C47DA0E1A7CD14C92EA990CA75CE1825A8850F6CE93A84F35811853A8EEE25F84AC47CE5277840D87C9300D22D099350E83EAAC9FB9A313CD166783563292A48A58AA33D051E9F167EF14CF683BCEB567E43CF5DA087D5465B9D796FE2FE045CA0E5E64BA329139ACAF4EC20A33F72DAA7471506102AFAE7C899A64CA502261C5225083B726ED305A3C1CFB099C7BF029FF094B1A666A81BDEB50EF0E856C40908B5B98365A1EF2C741DAFCDE7998C155B832737E6C346A1B1D7F8365930A8E2EEED64D7BF4B01081ECC01D7B922EB8FC057EA69E2E247D7B9A46B08CB9342EA3DA79832C8A4446A3F724D9EE92AF3B5F11CBA1662E93A77C0B26BF944931CC983ECEAB108D9A588A3BB98951CF9F1E39C88156002CC63FBCE8F5311189A8CBD1A123B819209DA032819FDFF162833AE4E4F3A90D230DC57B100742C08A220BC254A81E05A0664AEFB3AA8321E410C0191704E54F596FE3CA7518F34D88AD002808701B4046117404BF0F601E89994714033059A082D1E6F5B72C143678726790C2AFD310E88499A200AF1DD89FB83E5996E7955EAD5F20A4FB4E50D078363D3C6863576166223548422D06A433F6587B0561D19893DAE484A59A0C4D45E0BF54135C38905A7F6735B7BCBF8367B59AF2CF6C299067BC3524346899B064507ACCCCCDF1DDB4AD95A4FAF9F84329A0D09A5A3CCB2D236A903BB5500EB11C6CB679872D6F1B60C3BE32B9224581B1AC34F71E2F8F9E4337DE3EF3F1644B90C2F901DD341A56DF512563AB202E3169F2ECB3AD614B220BA844CC3C8226BC1750B96CAA75A88B4035522AC24D79F5B39D11A534C01B5F32ED19E08EB74661A9821B6F9B2999330223A1AC6346669C4B7359D5DDC790B68F2E727B684B167286EBAC6B37C6360D4F474AF381429F31971C86BC0FE71D8C2F7B5E3B04D42ABCF3605B52E5E3FAEEDCAD411DCB2E6EE0E6049D52B4ABA9E768DB4EDBA6ABBA2576073195DE1D5AEA8DEDD4FA5A2591CA8D2DECA60290C6936B7CCA49EC1AAF9AB8FA166B7B1C36E351D93A4025DD57C8C26332E0AFECB6BB7D5017212D741DB9FD1C358FDFD8D54100D34C1C0FF8D4D194598D7045784D32548950FFB2E6EBF27C6F6FEDFD9A43D2943D6679D7EF5754551BEA1DAAD9FB1DAF26722822722BE8BC8FAFBA6247BD1D873697C757764AE78713F7B1D5FF55ACA42FCAC7A2D655DABD8630710ACAD60C643584FDCDF33C69133FBE5B1E43D726E0466E2C8193A7F1C16F7C376B146EBD96F5DB267F6439638041B088D05C2B0544A25B0585AFDF71617F3802684B574B63B451F046BFF55F2CC9B7348806B68B6CCEAF3D0AE9658493552E925DBF75C48ED45A0C7C6B97DE1CC9B0866C542073607E396DDAB7319DDBE8B7649EEDE0BBFE09EDAB2BEB175BCB899DAEBEC97D945EDF68F88697C378F609574558BD0130D87A085958A66C69771095A43A392C4A86957A00816447226145D9240E175005266DF903D109622C945B48070C66F5295A40A4D8668C15ADFB869E8EF7A3F5BB8DB3A8F6F92ECDBAC7FC3045493EA9A7EC33FA4948595DE97764DDF2642E754D1BD742C95EE62AB4D25E93AE63D0515EEAB4AC11CA284A13079C37DF20C87E8762FE123AC48B029A7B8ED425E0E44DBEDE3734A568244B29051F3EBFF3779FA1F4EEFFE0131CE6442A21A0000 , N'6.4.4')
END

IF @CurrentMigration < '202011261619250_AddClassificationColumnToVideoTable'
BEGIN
    ALTER TABLE [dbo].[Videos] ADD [Classification] [int] NOT NULL DEFAULT 0
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202011261619250_AddClassificationColumnToVideoTable', N'VidzyCodeFirst.Migrations.Configuration',  0x1F8B0800000000000400D559DD6EDB3614BE1FB0771074B50DA96527375B60B768DDA4305627419C14BB2B68E9D82146511A4905F6863DD92EF6487B851DEA9FA4ECC86E9B6E285058E43987E7E7E3F961FEF9EBEFF1AB4DCCBC471092267CE28F0643DF031E2611E5EB899FA9D58B1FFD572FBFFD667C11C51BEF434577A6E99093CB89FFA0547A1E04327C8098C8414C4391C864A506611207244A82D3E1F0A760340A0045F828CBF3C6B719573486FC033FA7090F21551961F3240226CB75DC59E452BD2B12834C490813FF038D7EDF4E91EC920AA97CEF35A304B558005BF91EE13C5144A18EE7F712164A247CBD487181B0BB6D0A48B7224C42A9FB7943DED78CE1A9362368182B51612655121F28707456FA25B0D98FF2AE5FFB0D3D77811E565B6D75EEBD89FF0EB840CBED93CEA74C682ADBB3839CFEC433574F6A0C2054F4BF136F9A3195099870C89420ECC4BBC9968C863FC3F62EF915F884678CB53543DD70CF58C0A51B91A420D4F61656A5BEB3C8F702932FB0196BB6164F61CC9BAD4263AFF06CB26450C73DD8CBAEFFAF042078F00EF8DE9C6CDE035FAB87898F3F7DEF926E20AA564AA9F79CE29541262532F7902BF248D7B9AFADE3D0B59048DFBB05966FCB079A16481EE45B1FCB905D8A24BE4D58C5512C7FBC23620D7801EE12776F916422B43419070D24F602251774005072FAFF2D50665C9D9D7620A565F8422502D0B1208882E8862805826B1990BBEEEBA0CA3A04310444C25BA2EAB3F4EF3B1A1F7E0DA68C484957342C5351A9BAC6A5BDF594E49DD82FA17D1CF42B787741BFBA16FDA09FC52DE0DBC6CDE42523EBA668F4BE11A6A0CF753510101108B64500B5A16B3A7C0EF1124469D082322CEDBEF781B00C3F474E780CEA77098B6ADAD3FDB4373A6CE8BD9AFECCF578E1DBF6E26B299390E64E69E79A32D8E671173CF2F644BE816499AEE6E8429AA2D330CE13FF0747FD6E7975126DE495C833E50D0783916D61CB1A379F624BA308E5B5C34A0870051BD58124EC564A30C9F2BEDBDA6BA10B50EDEB83A5A3C1B5A9BD63BCC95E551E87BD74A6C5DEB2D49251DDD31645C735B673F8FED8D6CA367A06FD2454D16C49A81C651708D3A48E5C5107B0694683A21BADBAD66047DB3A9E9334C54BDA6A63CB156F51F4B0D3178BC31BBCB8901184B2A3CFABB5AD4FC29A45D660EDE2D15516C2EA409644A7B569143B64065C7760A93ACA40A41BA80A6115B9FE6DDC09A3E1B40534CEBB447B62ACB8B9696087D8E5CBA707C288E828FDD3846531DFD53EECE32E8A799BBF5871258C034B71DB3581E31B0BA3B6A77BC5A1BC329F108722071C1E871D7C5F3B0EBB24181D535B90B1D15F9EDD3DB445DA7BCF8F1633DF7540A6CAE4FB615151F58ABDCED25D238F99AD5D57F4824B21A30B34DA15F5B987A95496A023553A58194CB011CDBBA199D49D74DD69F631D4AE616ED89D526693D4A0AB4B9A55BAC6651979FA59C6A92B0589EFA1ED8FE861AC298BAD54100F34C160F11B9B328A306F08E684D315485574BCFEE970746ABDEEFC775E5A022923D6E7B9E5D9C759ECCA7140509FF4F4C11F89081F88F82E269BEFDB92DC41F4C04785677747EE8A27E7F7E7F155AFA13DC2DFEAF30DEDC740A1493816A49CA9658603E966E2FF91339E7BB35F3E56BC27DEB5C03B7DEE0DBD3F8F43D071B362AB881D36CEB933C5314326C21684461561987425CEF2D4ADE43782F290A684193ABB35A7CF5DD0FEABE5D93B6F2105AE416E98D5E7A07DC5B5966A5DCAA76C3F70607607951E13F1EE81B8284778BF963AB0051877CC869DC3F2EE59B94B72F7DCFA05E768C3FAD654F4E4E4EC8EDB5F6656761B09444CEBAF40085649D78D08DD1B71080DACD43433BE4A2AD05A1A5524564E9B8322985AC96BA1E88A840AB743C07CA9DF62CB17AC8B7809D18C5F672ACD149A0CF192196FBB1AFAFBCECF1F044C9DC7D769FEBAF9394C4035A9AE0ED7FC4D465B2F75976E4EDF2542DFA9B20EEA582A5D0FD7DB5AD255C27B0A2ADD57A7823B885386C2E4355F90473846B77B09EF614DC26DD50FEE16F274204CB78FDF52B2162496A58C861F3F11C351BC79F92F68973CB80C1D0000 , N'6.4.4')
END

IF @CurrentMigration < '202011270853538_ConfigureVideosAndGenresTables'
BEGIN
    IF object_id(N'[dbo].[FK_dbo.Videos_dbo.Genres_Genre_Id]', N'F') IS NOT NULL
        ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [FK_dbo.Videos_dbo.Genres_Genre_Id]
    IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_Genre_Id' AND object_id = object_id(N'[dbo].[Videos]', N'U'))
        DROP INDEX [IX_Genre_Id] ON [dbo].[Videos]
    EXECUTE sp_rename @objname = N'dbo.Videos.Genre_Id', @newname = N'GenreId', @objtype = N'COLUMN'
    DECLARE @var0 nvarchar(128)
    SELECT @var0 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Genres')
    AND col_name(parent_object_id, parent_column_id) = 'Name';
    IF @var0 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Genres] DROP CONSTRAINT [' + @var0 + ']')
    ALTER TABLE [dbo].[Genres] ALTER COLUMN [Name] [nvarchar](255) NOT NULL
    DECLARE @var1 nvarchar(128)
    SELECT @var1 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Videos')
    AND col_name(parent_object_id, parent_column_id) = 'Name';
    IF @var1 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [' + @var1 + ']')
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [Name] [nvarchar](255) NOT NULL
    DECLARE @var2 nvarchar(128)
    SELECT @var2 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Videos')
    AND col_name(parent_object_id, parent_column_id) = 'Classification';
    IF @var2 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [' + @var2 + ']')
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [Classification] [tinyint] NOT NULL
    DECLARE @var3 nvarchar(128)
    SELECT @var3 = name
    FROM sys.default_constraints
    WHERE parent_object_id = object_id(N'dbo.Videos')
    AND col_name(parent_object_id, parent_column_id) = 'GenreId';
    IF @var3 IS NOT NULL
        EXECUTE('ALTER TABLE [dbo].[Videos] DROP CONSTRAINT [' + @var3 + ']')
    ALTER TABLE [dbo].[Videos] ALTER COLUMN [GenreId] [tinyint] NOT NULL
    CREATE INDEX [IX_GenreId] ON [dbo].[Videos]([GenreId])
    ALTER TABLE [dbo].[Videos] ADD CONSTRAINT [FK_dbo.Videos_dbo.Genres_GenreId] FOREIGN KEY ([GenreId]) REFERENCES [dbo].[Genres] ([Id]) ON DELETE CASCADE
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202011270853538_ConfigureVideosAndGenresTables', N'VidzyCodeFirst.Migrations.Configuration',  0x1F8B0800000000000400D5595F6FDB36107F1FB0EF20E87148ADD841812DB05BA44E5218AB93204A8ABD15B47476885194465281DD619F6C0FFB48FB0A3B4A942C5192A3387FD62240609377C7FBF3BBE31DFDEFDFFF8CDFAF23E6DC839034E613773838741DE0411C52BE9AB8A95ABEF9D97DFFEEC71FC66761B4763E1774479A0E39B99CB8774A25C79E27833B88881C443410B18C976A10C49147C2D81B1D1EFEE20D871EA008176539CEF83AE58A46907DC1AFD3980790A894B0791C0293661D77FC4CAA73412290090960E27EA6E1D7CD14C9CEA990CA754E1825A8850F6CE93A84F35811853A1EDF4AF09588F9CA4F7081B09B4D0248B7244C82D1FD784BDED78CC39136C3DB3216A28254AA387AA4C0E191F18B67B3EFE55DB7F41B7AEE0C3DAC36DAEACC7B13F723708196DB271D4F99D054B6670719FD81535F3D28318050D17F07CE34652A1530E1902A41D88173952E180D7E85CD4DFC3BF0094F19AB6A86BAE15E6D0197AE449C80509B6B581A7D67A1EB78753ECF662CD92A3CB9311F360A8DBDC0B3C9824119776F27BBFE5F0840F0600EB8CE9CAC3F015FA9BB893B7AFBD675CEE91AC262C548BDE51453069994487B9C7A41EEE92A73BE753EFA1A62E93AD7C0B26D7947931CDA836CEB8B89E1B988A3EB98151CF9F2971B22568019711337F7FC381581A5C9D8DB6264277232418F404E46FFDD2267C6D5D1A8258815C37D150B40C782200AC22BA21408AE6540E6BA6F0466D6A9082A20124E892A0FD79F6F68F4785919A89E986C5346A4A44B1A988267FCA1C16E6FED9D50265FF6CBA72267DAF2A9C8B57EF99446956CB28D9BC9734656DBABA9779AD5053D57BE21CA42106C83A8AC04B7EEEF39440B10C61E9F32EC1F5CE73361297E1D36A253A3FE18B3B0A41DEDA6BDD25143E795F4474D87E7AEAD2E9E48190734F349B57E9958D78F3BE3A1B323F05B449A1238470FD2047D86619EB83F35D46F975716E6AD3C03BCBABCA16BD7B64B7E8A59ABC03909F2A6624A6440C26606A027C2FA0A964310BA1E1186ED95C48053AE9AB593F2802684756B6DB1F42CB85AA552B8BD730A09705D2BBB7DDFE7D4B208358F2E4FB0BCF49053C65E053DCD3B1179147294003519C715AC554BE2620B6A72579A9A6DA3450BF541550DC2EB7F5B46EA686980ADCE5E740F0D76035E8BBD62A925A3288B158A96AA693B7D772E95CA6EF56C846D77F65424148EB293A06E524B692E03B89D30BC7CC4284611AF631619CF4992604DACCC2666C5F1F3C164FAC67F7CD71EE532BC40B634EFA5B6E549D877901558BB787451F4F142270BA26F91691835C86A70EDC05271540D91CD4015082BC8F5E75A4ED4A6889674368CE7684FA42B41D652D9216EF26523216144B4B46FD398A511EFAE48DDDC794356E5CF579A12C69EA578A3F4347CD328D4754FF78A83499927C421AF018F8F4307DFFF1D872E09B526B72AA8B6D15F5E79C75465755E3CDD72ECA6AF2ACEDE7B65D4356AA34D529E5ED648AB168E4D5D7AF8F1A651A87212D74177DD23D2B048F91BA9201A688281FF079B328AF66E09E684D325489577ACEEE87038B2DE80BE9DF7184FCA90F5799479F51917DB6A6CF0D5931E48F83D11C11D11CDD975A7D047BE3ABCBA6B32B73C38E0BFBEDF7A0DF4217E56CF30D097F868F4B4336CABD713F7CF8CEFD899FDF6C5B01E389702F3F3D83974FE7AA6B7807E28ED02D47E73A0697D5F7554B3FADE7D06CFBDA6BDAEDEEC6506BCEF64A66BF6D23D86B6EE992DBFE03033173AAE39883BC697D679AE7B9C6B93DC3E5ABDE0A857B3BED2B83F38DC3527C29719E79AAD0922A6F2EB136255D2D55684FE2D8A4350C34A4933E3CBB8C0ACA551416215B639288245999C0845972450B81D00963AFDE46B1EB5CEA20584337E99AA24556832440B567B42D6D0DF757E36B3D6751E5F26D97BE77398806A527DAF5CF20F29AD3CDE9DB794E20E113AA7CC6DAA63A9F4ADBADA94922E62DE5390715F590A6E204A180A9397DC27F7B08F6EB7123EC18A049BA2C3EC16F27020EA6E1F9F52B212249246C6961FBF2286C368FDEE3F0BE441BB841D0000 , N'6.4.4')
END

IF @CurrentMigration < '202011270930247_AddTagsTable'
BEGIN
    CREATE TABLE [dbo].[Tags] (
        [Id] [int] NOT NULL IDENTITY,
        [Name] [nvarchar](255) NOT NULL,
        CONSTRAINT [PK_dbo.Tags] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[VideoTags] (
        [TagId] [int] NOT NULL,
        [VideoId] [int] NOT NULL,
        CONSTRAINT [PK_dbo.VideoTags] PRIMARY KEY ([TagId], [VideoId])
    )
    CREATE INDEX [IX_TagId] ON [dbo].[VideoTags]([TagId])
    CREATE INDEX [IX_VideoId] ON [dbo].[VideoTags]([VideoId])
    ALTER TABLE [dbo].[VideoTags] ADD CONSTRAINT [FK_dbo.VideoTags_dbo.Tags_TagId] FOREIGN KEY ([TagId]) REFERENCES [dbo].[Tags] ([Id]) ON DELETE CASCADE
    ALTER TABLE [dbo].[VideoTags] ADD CONSTRAINT [FK_dbo.VideoTags_dbo.Videos_VideoId] FOREIGN KEY ([VideoId]) REFERENCES [dbo].[Videos] ([Id]) ON DELETE CASCADE
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'202011270930247_AddTagsTable', N'VidzyCodeFirst.Migrations.Configuration',  0x1F8B0800000000000400ED5ADB6EDC36107D2FD07F10F4583896ED20406BEC2670D67660B4BEC0EB047D336889BB264A51AA4819DE16FDB23EF493FA0B1DEA4249BC68A5F5DA498A2040E02539C3B99C992187FAF7EF7F26EF1E63EA3DE08C93844DFDFDDD3DDFC32C4C22C296533F178B573FFAEFDE7EFFDDE4248A1FBD4FF5BAD7721D50323EF5EF85480F838087F738467C37266196F0642176C3240E509404077B7B3F05FBFB0106163EF0F2BCC975CE048971F1037ECE1216E254E4889E2711A6BC1A879979C1D5BB4031E6290AF1D4FF44A23F563358764A322E7CEF88120452CC315DF81E622C1148808C871F399E8B2C61CB790A0388DEAC520CEB1688725CC97ED82C1FAAC6DE81542368086B5661CE45128F64B8FFBAB24BA0936F645D5FD90D2C770216162BA97561BDA9FF01B30C34D7773A9CD14CAED22DBB5BACDFF1BAA33B0A030015F96FC79BE554E4199E329C8B0CD11DEF2ABFA324FC19AF6E92DF309BB29CD2B664201BCC750660E82A4B529C89D5355E54F29E45BE1774E9029D5091B5684A65DEAF04287B017BA33B8A95DF835E72F97FCD00C00331E07BE7E8F117CC96E27EEA1FBC79E37BA7E41147F548C5F5232310324024B27CC0AE17E8812C0BE36BFB83AD71C27DEF1AD3629ADF93B484F66E31755BF9F0344BE2EB84D614E5F0ED0DCA961822E22631E7E6499E859A2493A0C1482F720A46239053ACFF6A9173C6C4EB038B135B8ACF459261302CCE90C0D1151202674CF2C085E9BE109869BB02A830E2F81809B5B9FCFB86C4E37915A07A62B0CD28E29C2C485825BCCA1E12ECFAD4C60155C5CB66F154C78C2D9EEA581B2AC80D5ADAE31A266EEBB06FC468468DA86E4D3D29A881CF889086D5DF02FA7307F42675632DBE74945BA0370C5F79DC42971EC167FC94420828CD0603AFCB685B1804CB4738A32BF0542B8375AD7D8EE33B9C55FACC098543B2EF7D4234879FFB866F3AAB3F2434526B0FFAD75E499781F1D4FAD7A6C14BD3B6078F384F4252D8A48D812AA175B73B6191D793DD9AB45BD5F973B02049C166E0E6A9FF8321BE9D9FCA530DBF2ABB76F9EDFB7ABC5FB263284D027B476179729E211EA2C8C43F5822EA8E408AC0998C5144E10EC1C1E18409339F1016921451B7D41AC9C024244552CCF599639C6226F387DBF643765595D6DC5AEDA059699D5126410B3DFDA06A650F17066CA9A4814051658603CA56F7C6E1D3A95C99B6C02002CCA1A2AF4A274CE04761C94A7089AC1213AF92B42EB9643AC7A2ED2DC8B44D8EEC8682A17897BC4ED40679A5F91AF2F2906110173ED0485B46D2B6AFCF44AD159623930EC6FE1CA3046D5434E0DC9F555A1C6A1BEBC9A1ABD20075DBA5D1D4D605FD75E06F495AFAA347530BDCD79AAA47D1BA362B90377D94A06CA4D40D97C0D171999CA33485A2D8EAC05423DEBC6CBFCC5ECDC7F726E2924710724B8B4249AB7682C3185A626D16B6AEAB3E5C5BD01D92C78859141BCB3A21ED08987AAB4ED49A7EAA03A95E2EFFEEE48D4EAFC492CF2BC253D02796A5A03867EA5836E98AC617A228B39C696709CD63E62E496EEAF294DAA62F474C0E934013DCA83D866D8C4ADDB5F4203F38C36DB01FCA3C39DE0F0EBACFED071787CE55BECDA833319C9F3A64B479394F1E6E3EFAA9BFCD4E9FFB62505764E927604E96D7F188B3527D6EBC3DB707BA95CB7083AAC67DB6568B2C16B586B1ACB76637462BDBA62906390218D9CFE6AD3D4789E3BC8F0C12A760324E20FD3861FACD3855E84B146AD4E9423B454CAA8ABEFE71C728F1E512DF03D91F403928EFF3151738DE950B76E7BFD3192580D366C139626481B9282FFBFEC1DEFE81F646F4E5BCD7049C4774C8A3CD8BB7CC04612B22CDFA840714F680B2F01E65662BAC97E9C8578917374D6196B5FDC297B7DBA0867F047F8B2D34FC153E8C1BF3198BF0E3D4FFB3A03BF4CE7EBDAD4877BCCB0CE2F3D0DBF3FEDAD25BC130948EEA887F83D30656DB38125DE5D35CE9A86CEB2D5D6DD132F600C816444F02AC9277DCC615D988AD5D7EDAAC415CF57E5EB487AB357E36E9486FD40676DDD99FA7F3FB55357BADA7E26EDF6A5D97F79920A2B28DB6FD7302C57EC1DB3A4C5CF7975199F3857162BBAE8C0FE8FF1156867BF025D1D2732FDC3A5EECEF2C66EFD6D19BE97EB8E17A4729AF85709EBD93DE2D8BA3E35DC0FAC6E27E62B1717634E22DCF2FAED7171B57DBEB808DA74BE066CA29B3758BE77BFAE938ADD5DF5EFBD8633E7B6CF57947BDCDF4BDF2383A417AD5D35A786B5E774CED9AC16D2A58BF1EF52A68EF2D8DF7C5B32839E2EDCAEC2641BA6A7D500CB9929365C3427E5ECC70D849546ACD195B2475C2D424AA976847FB732C10DCA3D15126C8028502A6430CB753F9D14FF509C7497C87A33376998B3417A0328EEF68E723229977FBF62F1EE8BA324F2ED3E2D39E6DA8006212D90AB864EF73D2FA54E5D472BF70B09009BDBAB14A5F0A79735DAE14A78B840D6454994FD5A11B1CA71498F14B36470F7813D93E72FC0B5EA270553705DD4CD63BA26BF6C93141CB0CC5BCE2D1D0C34FC070143FBEFD0F6624A518572F0000 , N'6.4.4')
END

